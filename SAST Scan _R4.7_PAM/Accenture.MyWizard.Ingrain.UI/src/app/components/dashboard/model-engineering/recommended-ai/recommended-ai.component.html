<!-- <fieldset [disabled]="readOnly"> -->
<div id="main" class="myw-content d-flex flex-column flex-fill">
  <!-- Description -->
  <div id="dvPrescription" [ngClass]="prescriptionStatus ? 'open' : 't'" class="ingrain-flyout-container prescription">
    <div class="ingrain-flyout" style="margin-left: -1rem;">
      <div class="ingrain-flyout-content myw-scrollbar" style=" max-height: 22rem;">
        <fieldset [disabled]="readOnly">
          <ng-container *ngIf="isTrainingStart; then explainableTemplate else  prescriptionTemplate"></ng-container>
          <ng-template #prescriptionTemplate>
            <div class="ingrAI-list-item" id="dvPrescription">
              <label class="checkcontainer" style="cursor: auto;">
                <span>Please train all the recommended/available options to arrive at the best fit model</span>
              </label>
            </div>
          </ng-template>

          <ng-template #explainableTemplate>
            <div *ngIf="classificationAIShow" id="dvAITempClassification">
              <div class="ingrAI-list-item">
                <ul class="ingrAI-list-item">
                  <li>
                    <ng-container *ngIf='explainableAIAccuracyValue>80'>
                      Identified {{explainableAImodelName}} as best-fit model for the selected problem statement with
                      maximum accuracy of {{explainableAIAccuracyValue}} % and run time of
                      {{explainableAIRunTime}}s
                    </ng-container>

                    <ng-container *ngIf='explainableAIAccuracyValue == 60 || explainableAIAccuracyValue < 79.9'>
                      Identified {{explainableAImodelName}} as best-fit model for the selected problem statement with
                      maximum accuracy of {{explainableAIAccuracyValue}} % and run time of
                      {{explainableAIRunTime}}s.
                      <div>Suggest to perform hyper-tuning and evaluate data. Else click on Next to proceed.</div>
                    </ng-container>
                    <ng-container *ngIf='explainableAIAccuracyValue<60'>
                      None of the models are satisfactory. Please revisit the input parameters and check the data
                      quality to improve the accuracy, else, click on Next to proceed
                    </ng-container>
                  </li>
                </ul>
              </div>
              <div class="ingrAI-list-item">
                <ul *ngIf='explainableAIAccuracyValue>=60'>
                  <li>
                    ROC/AUC curves :Area under the curve is showing {{explainableAIROCAUCValue}}% indicates the
                    measure
                    of best-fit model
                  </li>
                </ul>
              </div>

            </div>

            <div *ngIf="regressionAIShow || timeSeriesAIShow" id="dvAITempRegression">
              <div class="ingrAI-list-item">
                <ul>
                  <li>
                    <ng-container *ngIf='explainableAIAccuracyValue>=80'>
                      Identified {{explainableAImodelName}} best-fit model for the selected problem statement with
                      accuracy
                      of {{explainableAIAccuracyValue}} and run time of {{explainableAIRunTime}}sec
                    </ng-container>
                    <ng-container *ngIf='explainableAIAccuracyValue == 60 || explainableAIAccuracyValue < 79.9'>
                      Identified {{explainableAImodelName}} best-fit model for the selected problem statement with
                      accuracy of {{explainableAIAccuracyValue}} and run time of
                      {{explainableAIRunTime}}sec.
                      <div> Suggest to perform hyper-tuning and evaluate data. Else click on Next to proceed</div>
                    </ng-container>
                    <ng-container *ngIf='explainableAIAccuracyValue < 60'>
                      None of the models are satisfactory. Please revisit the input parameters and check the data
                      quality to improve the accuracy, else, click on Next to proceed
                    </ng-container>
                  </li>
                </ul>
              </div>
              <div class="ingrAI-list-item" *ngIf="regressionAIShow">
                <ul *ngIf='explainableAIAccuracyValue>=60'>
                  <li>
                    Coefficient of determination (R² Value): R² Value is showing {{explainableAIr2Value}} indicates
                    the measure of best fit model
                  </li>
                </ul>
              </div>

              <div class="ingrAI-list-item" *ngIf="timeSeriesAIShow">
                <ul>
                  <li>
                    Coefficient of determination (Mae Value): Mae Value is showing {{explainableAIMaeValue}} indicates
                    the
                    measure of
                    best fit model
                  </li>
                </ul>
              </div>
              <div class="ingrAI-list-item" *ngIf="timeSeriesAIShow">
                <ul>
                  <li>
                    Chart shows the actual vs prediction outcome for Test Data
                  </li>
                </ul>
              </div>
            </div>

            <div *ngIf="textClassificationAIShow" id="dvAITempClassification">
              <div class="ingrAI-list-item">
                <ul>
                  <li>
                    Identified {{explainableAImodelName}} as best-fit model for the selected problem statement with
                    maximum
                    accuracy of {{explainableAIAccuracyValue}} % and run time of {{explainableAIRunTime}}s
                  </li>
                </ul>
              </div>
              <div *ngIf="!isTextPreProcessing" class="ingrAI-list-item">
                <ul>
                  <li>
                    ROC/AUC curves: Area under the curve is showing {{explainableAIROCAUCValue}}% indicates the
                    measure
                    of best fit model
                  </li>
                </ul>
              </div>
            </div>
          </ng-template>
        </fieldset>
      </div>
      <div class="ingrain-fly-header">
        <div class="ingrain-flytext" (click)="prescriptionOpen()">Prescription</div>
      </div>
    </div>
  </div>
  <!-- /Description -->
  <fieldset [disabled]="readOnly">
    <div class="myw-container py-4">

      <div class="myw-section">
        <div class="row align-items-center my-3">
          <div class="col ingrain-bdr">
            <div class="ingrain-reg-col d-flex flex-fill">
              <ng-container
                *ngIf="this.selectedModelOnLoad === 'Regression' || this.selectedModelOnLoad === 'regression'">
                <a id="btnRegression" [ngClass]="{'disabled': disableRegression}" (click)="loadRegressionModel()"
                  href="javascript:;" class="ingrain-reg-item text-decoration-none modelname-tab active">
                  <img src="assets/images/regression.svg" alt="Regression" /> <span>Regression</span>
                </a>
              </ng-container>
              <ng-container
                *ngIf="this.selectedModelOnLoad !== 'Regression' && this.selectedModelOnLoad !== 'regression'">
                <a id="btnRegression" [ngClass]="{'disabled': disableRegression}" (click)="loadRegressionModel()"
                  href="javascript:;" class="ingrain-reg-item text-decoration-none modelname-tab">
                  <img src="assets/images/regression.svg" alt="Regression" /> <span>Regression</span>
                </a>
              </ng-container>
              <ng-container
                *ngIf="this.selectedModelOnLoad === 'TimeSeries' || this.selectedModelOnLoad === 'timeseries'">
                <a id="btnTimeSeries" [ngClass]="{'disabled': disableTimeSeries}" (click)="loadTimeSeries()"
                  href="javascript:;" class="ingrain-reg-item text-decoration-none modelname-tab active">
                  <img src="assets/images/time-series.svg" alt="Time Series" /> <span>Time Series</span>
                </a>
              </ng-container>
              <ng-container
                *ngIf="this.selectedModelOnLoad !== 'TimeSeries' && this.selectedModelOnLoad !== 'timeseries'">
                <a id="btnTimeSeries" [ngClass]="{'disabled': disableTimeSeries}" (click)="loadTimeSeries()"
                  href="javascript:;" class="ingrain-reg-item text-decoration-none modelname-tab">
                  <img src="assets/images/time-series.svg" alt="Time Series" /> <span>Time Series</span>
                </a>
              </ng-container>
              <ng-container
                *ngIf="this.selectedModelOnLoad === 'Classification' || this.selectedModelOnLoad === 'classification' || this.selectedModelOnLoad === 'Multi_Class'|| this.selectedModelOnLoad === 'Text_Classification'">
                <a id="btnClassification" [ngClass]="{'disabled': disableClassification}" (click)="loadClassification()"
                  href="javascript:;" class="ingrain-reg-item text-decoration-none modelname-tab active">
                  <img src="assets/images/classification.svg" alt="Classification" /> <span>Classification</span>
                </a>
              </ng-container>
              <ng-container
                *ngIf="this.selectedModelOnLoad !== 'Classification' && this.selectedModelOnLoad !== 'classification' && this.selectedModelOnLoad !== 'Multi_Class' && this.selectedModelOnLoad !== 'Text_Classification'">
                <a id="btnClassification" [ngClass]="{'disabled': disableClassification}" (click)="loadClassification()"
                  href="javascript:;" class="ingrain-reg-item text-decoration-none modelname-tab">
                  <img src="assets/images/classification.svg" alt="Classification" /> <span>Classification</span>
                </a>
              </ng-container>
            </div>
          </div>

          <ng-container *ngIf="isTrainingStart; then startTrainningTemplateRevamp else recommendedModelTemplateRevamp">
          </ng-container>

          <ng-template #recommendedModelTemplateRevamp>
            <div class="col">
              <div class="ingrain-reg-col">
                <div class="row align-items-center">
                  <div class="ingrain-reg-col-usage col">
                    <div class="ingrain-chart-md">
                      <app-d3-donut-chart [donutInnerRadius]=35 [pageInfoForDonutChart]="'StartTrainning'"
                        [pythonProgressVal]="pythonProgressVal">
                      </app-d3-donut-chart>
                    </div>
                  </div>
                  <!-- <div class="ingrain-reg-col-usage col">
                    <span>CPU Usage:</span>
                    <span>{{cpuUsageValue}}%</span>
                  </div> -->
                  <div class="ingrain-reg-col-usage col-auto" style="margin-right: 3rem;">
                    <input type="button" class="btn btn-primary btn-lg" [disabled]=!isTrainingBtn value="Start Training"
                      (click)="startTrainingAI()" />
                    <div class="fs-12 mt-2">Estimated Run Time: {{totalEstimatedRuntime}}s</div>
                  </div>
                </div>
              </div>
            </div>
          </ng-template>

          <ng-template #startTrainningTemplateRevamp>
            <div class="col">
              <div class="ingrain-reg-col">
                <ng-container *ngIf="cpuUsageValue>=70 && cpuUsageValue<100">
                  <div class="row align-items-center">
                    <div class="ingrain-reg-col-usage col">
                      <div class="ingrain-chart-md">
                        <app-d3-donut-chart [donutInnerRadius]=35 [pageInfoForDonutChart]="'StartTrainning'"
                          [pythonProgressVal]="pythonProgressVal">
                        </app-d3-donut-chart>
                      </div>
                    </div>
                    <!-- <div class="ingrain-reg-col-usage col">
                    <span>CPU Usage:</span>
                    <span>{{cpuUsageValue}}%</span>
                  </div> -->
                    <div class="ingrain-reg-col-usage col">
                      <span style="font-weight: normal;">System is busy,</span>
                      <span>Please wait</span>
                    </div>
                    <div class="ingrain-reg-col-usage col-auto">
                      <ng-container *ngIf='!retrainModels'>
                        <input type="button" class="btn btn-primary btn-lg" [disabled]="true" value="Start Training"
                          (click)="startTrainingAI()" />
                      </ng-container>
                      <ng-container *ngIf='retrainModels'>
                        <input type="button" class="btn btn-primary btn-lg" [disabled]="!retrainModels"
                          value="Restart Training" (click)="reStartTraining(confirmRetrainModels,$event)" />
                      </ng-container>
                      <div class="fs-12 mt-2" style="text-align: center;">Time Taken: {{trainingCompletionTime}}s</div>
                    </div>
                  </div>
                </ng-container>

                <ng-container *ngIf="cpuUsageValue < 70 || cpuUsageValue == 100">
                  <div class="row align-items-center">
                    <div class="ingrain-reg-col-usage col">
                      <div class="ingrain-chart-md">
                        <app-d3-donut-chart [donutInnerRadius]=35 [pageInfoForDonutChart]="'StartTrainning'"
                          [pythonProgressVal]="pythonProgressVal">
                        </app-d3-donut-chart>
                      </div>
                    </div>
                    <!-- <div class="ingrain-reg-col-usage col">
                    <span>CPU Usage:</span>
                    <span>{{cpuUsageValue}}%</span>
                  </div> -->
                    <div class="ingrain-reg-col-usage col-auto" style="margin-right: 3rem;">
                      <ng-container *ngIf='!retrainModels'>
                        <input type="button" class="btn btn-primary btn-lg" [disabled]="true" value="Start Training"
                          (click)="startTrainingAI()" />
                      </ng-container>
                      <ng-container *ngIf='retrainModels'>
                        <input type="button" class="btn btn-primary btn-lg" [disabled]="!retrainModels"
                          value="Restart Training" (click)="reStartTraining(confirmRetrainModels,$event)" />
                      </ng-container>
                      <div class="fs-12 mt-2" style="text-align: center;">Time Taken: {{trainingCompletionTime}}s</div>
                    </div>
                  </div>
                </ng-container>

              </div>
            </div>

            <!-- carousel Button -->
          </ng-template>
        </div>
      </div>

      <ng-container *ngIf="isTrainingStart; then startTrainningTemplate else recommendedModelTemplate"></ng-container>

      <ng-template #recommendedModelTemplate>

        <div class="myw-section">
          <div class="table-responsive">
            <table class="table table-striped table-hover table-vmiddle myw-table">
              <thead>
                <tr class="txt-capital">
                  <th scope="col">Recommended models
                    <!-- <a href="javascript:;"><img src="assets/images/info.svg" alt="Info" class="myw-icon myw-12" /></a> -->
                  </th>
                  <th scope="col">Estimate run time <span style="text-transform: lowercase;">(sec)</span></th>
                  <th scope="col">Select</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let model of recommendedModelNamesBeforeTraining; let i = index">
                  <td>
                    {{model}}
                  </td>
                  <td>{{runTimeOfRecommendedModels[model]}}</td>
                  <td>
                    <label class="myw-switch">
                      <input #switch type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" [id]="'estime1'+ i"
                        [checked]="isModelChecked[model] == 'True'" (click)="onSwitchChanged(switch, model)">
                      <span class="label-first">OFF</span>
                      <span class="switch-toggle"></span>
                      <span class="label-last">ON</span>
                    </label>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

      </ng-template>

      <ng-template #startTrainningTemplate>
        <!-- carousel Button -->

        <ng-container *ngIf="trainedModels.length==1">
          <div class="myw-carousel myw-chart-carousel" style="padding: 0 40%;">
            <div id="carouselExampleControls" class="carousel slide mb-3" data-ride="carousel" data-interval="false">
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <div class="d-flex">
                    <ng-container *ngFor='let name of trainedModels; let i = index'>
                      <div class="myw-col">
                        <div class="card" (click)="getBestModel(name.Accuracy,name.modelName,name.RunTime,i)"
                          id="dvModelDetailsContainer" [ngClass]="{'active': selectedIndex == i}" style="margin-right: 1rem;
                        width: 193.021px;">
                          <div class="card-header" style="height: 30%;">
                            <div class="card-title" style=" word-break: break-all;">{{name.modelName}}</div>
                          </div>
                          <div class="card-body d-flex flex-column align-items-center">
                            <div class="ingrain-chart">
                              <app-d3-donut-chart [donutInnerRadius]=50 [trainedModelAccuracy]=name.Accuracy
                                [pageInfoForDonutChart]="'TrainedModel'" [selectedModelOnLoad]="selectedModelOnLoad"
                                (selectedAIModelAccuracy)="receiveSelectAccuracy($event)">
                              </app-d3-donut-chart>
                            </div>
                            <div class="fs-12 mt-auto">Run Time: {{name.RunTime}}s</div>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>


        <ng-container *ngIf="trainedModels.length==2">
          <div class="myw-carousel myw-chart-carousel" style="padding: 0 30%;">
            <div id="carouselExampleControls" class="carousel slide mb-3" data-ride="carousel" data-interval="false">
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <div class="d-flex">
                    <ng-container *ngFor='let name of trainedModels; let i = index'>
                      <div class="myw-col">
                        <div class="card" (click)="getBestModel(name.Accuracy,name.modelName,name.RunTime,i)"
                          id="dvModelDetailsContainer" [ngClass]="{'active': selectedIndex == i}" style="margin-right: 1rem;
                        width: 193.021px;">
                          <div class="card-header" style="height: 30%;">
                            <div class="card-title" style=" word-break: break-all;">{{name.modelName}}</div>
                          </div>
                          <div class="card-body d-flex flex-column align-items-center">
                            <div class="ingrain-chart">
                              <app-d3-donut-chart [donutInnerRadius]=50 [trainedModelAccuracy]=name.Accuracy
                                [pageInfoForDonutChart]="'TrainedModel'" [selectedModelOnLoad]="selectedModelOnLoad"
                                (selectedAIModelAccuracy)="receiveSelectAccuracy($event)">
                              </app-d3-donut-chart>
                            </div>
                            <div class="fs-12 mt-auto">Run Time: {{name.RunTime}}s</div>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>

        <ng-container *ngIf="trainedModels.length==3">
          <div class="myw-carousel myw-chart-carousel" style="padding: 0 23%;">
            <div id="carouselExampleControls" class="carousel slide mb-3" data-ride="carousel" data-interval="false">
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <div class="d-flex">
                    <ng-container *ngFor='let name of trainedModels; let i = index'>
                      <div class="myw-col">
                        <div class="card" (click)="getBestModel(name.Accuracy,name.modelName,name.RunTime,i)"
                          id="dvModelDetailsContainer" [ngClass]="{'active': selectedIndex == i}" style="margin-right: 1rem;
                        width: 193.021px;">
                          <div class="card-header" style="height: 30%;">
                            <div class="card-title" style=" word-break: break-all;">{{name.modelName}}</div>
                          </div>
                          <div class="card-body d-flex flex-column align-items-center">
                            <div class="ingrain-chart">
                              <app-d3-donut-chart [donutInnerRadius]=50 [trainedModelAccuracy]=name.Accuracy
                                [pageInfoForDonutChart]="'TrainedModel'" [selectedModelOnLoad]="selectedModelOnLoad"
                                (selectedAIModelAccuracy)="receiveSelectAccuracy($event)">
                              </app-d3-donut-chart>
                            </div>
                            <div class="fs-12 mt-auto">Run Time: {{name.RunTime}}s</div>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-container>

        <ng-container *ngIf="trainedModels.length>=4">
          <div class="myw-carousel myw-chart-carousel" style="padding:0 15%;">
            <div id="carouselExampleControls" class="carousel slide mb-3" data-ride="carousel" data-interval="false">
              <div class="carousel-inner">
                <div class="carousel-item active">
                  <div class="d-flex">
                    <ng-container *ngFor='let name of trainedModels; let i = index'>
                      <div class="myw-col">
                        <div class="card" (click)="getBestModel(name.Accuracy,name.modelName,name.RunTime,i)"
                          id="dvModelDetailsContainer" [ngClass]="{'active': selectedIndex == i}" style="margin-right: 1rem;
                  width: 193.021px;">
                          <div class="card-header" style="height: 27%;">
                            <div class="card-title" style=" word-break: break-all;">{{name.modelName}}</div>
                          </div>
                          <div class="card-body d-flex flex-column align-items-center">
                            <div class="ingrain-chart">
                              <app-d3-donut-chart [donutInnerRadius]=50 [trainedModelAccuracy]=name.Accuracy
                                [pageInfoForDonutChart]="'TrainedModel'" [selectedModelOnLoad]="selectedModelOnLoad"
                                (selectedAIModelAccuracy)="receiveSelectAccuracy($event)">
                              </app-d3-donut-chart>
                            </div>
                            <div class="fs-12 mt-auto">Run Time: {{name.RunTime}}s</div>
                          </div>
                        </div>
                      </div>
                    </ng-container>
                  </div>
                </div>
              </div>
              <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev"
                (click)='onCarouselPreviousBtn()'>
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
              </a>
              <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next"
                (click)=' onCarouselNextBtn()'>
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
              </a>
            </div>
          </div>
        </ng-container>

        <div class="myw-section p-3" *ngIf="isClassificationAccuracy">
          <div class="row">
            <div class="col-12 col-lg-8">
              <div class="row h-100">
                <div class="col-12">
                  <div class="card ingrain-card">
                    <div class="card-header">
                      <div class="card-title"><span>Receiver Operating Characteristics (ROC) / AUC Curve </span>
                        <app-info-tooltip style="font-weight: normal;">
                          <div class="htmlDesignedTooltip">
                            AUC – ROC curve is a performance measurement for classification models. ROC is a probability
                            curve and the AUC stands for Area under the curve. The larger the area coverage under the
                            curve, the better is the fit of the model. In case of an excellent model the value is near
                            to 1 which means it has good measure of separability. And when AUC is 0.5, it means model
                            has no class separation capacity whatsoever.
                            <div>
                              The ROC curve is plotted with True Positive Rate (TPR) against the False Positive Rate
                              (FPR) where TPR is on y-axis and FPR is on the x-axis.
                            </div>
                            <div>
                              Here, TPR = TP/ TP + FN
                              <p>FPR = FP/ TN + FP</p>
                            </div>
                          </div>
                        </app-info-tooltip>
                      </div>
                    </div>
                    <!-- <img style="height: 315px; width: 345px"
                    [src]="domSanitizer.bypassSecurityTrustUrl(selectedFineTuneImg_64)" alt="Select Image" /> -->
                    <img style="height: 260px;width: 365px;margin-left: 21%;"
                      [src]="domSanitizer.bypassSecurityTrustUrl(selectedFineTuneImg_64)" alt="Select Image" />
                  </div>
                </div>
                <div class="col-md-12 col-lg-6">
                  <div class="card ingrain-card">
                    <div class="form-row h-100">
                      <div class="col-6 ingrain-card-vr">
                        <div class="card-header">
                          <div class="card-title"><span>Accuracy</span>&nbsp;
                            <app-info-tooltip>
                              <div class="htmlDesignedTooltip">
                                Accuracy is the percentage of correct predictions given by the model. It is given by the
                                number of correct predictions divided by the total number of predictions * 100.
                              </div>
                            </app-info-tooltip>
                            <!-- <app-info-tooltip [labelTitle]="" [description]="''"> </app-info-tooltip> -->
                          </div>
                        </div>
                        <div class="card-body d-flex flex-column align-items-center justify-content-center h-100">
                          <div class="ingrain-chart" style="margin: -4rem 2rem 0rem 0rem;">
                            <app-d3-donut-chart [donutInnerRadius]=55 [selectedModelAccuracy]="selectedAccuracyValue"
                              [defaultModelAccuracyOnLoad]="defaultModelAccuracyOnLoad"
                              [pageInfoForDonutChart]="'Accuracy'">
                            </app-d3-donut-chart>
                          </div>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="card-header">
                          <div class="card-title"><span>F1 Score </span>
                            <app-info-tooltip>
                              <div class="htmlDesignedTooltip">
                                F1- Score is a measure of a Classification model’s accuracy on a dataset and is defined
                                as the harmonic mean of the model’s precision and recall.
                                <div>
                                  Where, Precision = True Positives/ (True Positive + False Positive)
                                  <div style="margin-left: 1.7rem;">
                                    Recall (Sensitivity) = True Positives/ (True Positives + False Negative)
                                  </div>
                                </div>
                                <div>A perfect model has an F1-Score of 1.</div>
                              </div>
                            </app-info-tooltip>
                          </div>
                        </div>
                        <div class="card-body d-flex flex-column align-items-center justify-content-center h-100">
                          <div class="ingrain-value fs-20" style="margin-top: -50%;">{{selectedModelF1Score}}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-12 col-lg-6">
                  <div class="card ingrain-card">
                    <div class="card-header">
                      <div class="card-title"><span>Confusion Matrix </span>
                        <app-info-tooltip>
                          <div class="htmlDesignedTooltip">
                            A confusion matrix is a table that is used to describe the performance of a classification
                            model on a set of test data for which the true values are known.
                            <div>
                              Here,
                              <div style="margin-left: 1.7rem;">
                                <ul>
                                  <li>
                                    <b>True Positives (TP)</b>: These are cases in which we predicted High Priority, and
                                    they do have High Priority.
                                  </li>
                                  <li><b>True Negatives (TN)</b>: We predicted Low Priority, and they do have Low
                                    Priority.
                                  </li>
                                  <li><b>False Positives (FP)</b>: We predicted High Priority, but they are actually Low
                                    Priority. (Also known as a "Type I error.")
                                  </li>
                                  <li><b>False Negatives (FN)</b>: We predicted Low Priority, but they are actually High
                                    Priority. (Also known as a “Type II error.”)
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </div>
                        </app-info-tooltip>
                      </div>
                    </div>
                    <div class="card-body">
                      <div class="ingrain-conf-table d-flex">
                        <div class="ingrain-conf-col">
                          <div style="font-size: 0.787rem;">Total n {{sumofTrueFalseValues}}</div>
                          <div class="ingrain-conf-act-text">——Actual——</div>
                          <div class="mt-auto" style="font-size: 0.787rem;">Column Sum</div>
                        </div>
                        <table class="table">
                          <thead>
                            <tr>
                              <th colspan="4" class="text-center">—————Predicted—————</th>
                            </tr>
                            <tr>
                              <th width="80px">&nbsp;</th>
                              <th class="text-center" width="80px">Yes</th>
                              <th class="text-center" width="80px">No</th>
                              <th>Rows Sum</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td class="text-right">Yes</td>
                              <td class="text-center">
                                <div class="conf-bg">TP {{selectedModelTruePositive}}</div>
                              </td>
                              <td class="text-center">
                                <div class="conf-bg">FN {{selectedModelFalseNegative}}</div>
                              </td>
                              <td> {{selectedModelTruePositive + selectedModelFalseNegative}}</td>
                            </tr>
                            <tr>
                              <td class="text-right">No</td>
                              <td class="text-center">
                                <div class="conf-bg">FP {{selectedModelFalsePositive}}</div>
                              </td>
                              <td class="text-center">
                                <div class="conf-bg">TN {{selectedModelTrueNegative}}</div>
                              </td>
                              <td> {{selectedModelFalsePositive + selectedModelTrueNegative}}</td>
                            </tr>
                            <tr>
                              <td>&nbsp;</td>
                              <td class="text-center">{{selectedModelTruePositive + selectedModelFalsePositive}}</td>
                              <td class="text-center">{{selectedModelFalseNegative + selectedModelTrueNegative}}</td>
                              <td>&nbsp;</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-12 col-lg-4">
              <div class="card ingrain-card">
                <div class="card-header">
                  <div class="card-title">Feature Weights</div>
                  <app-info-tooltip [className]="'toggleRight'">
                    <div class="htmlDesignedTooltip">
                      Influencing attributes in the trained model arranged in decreasing order of their weights. Weights
                      give a measure of
                      how much influence the particular attribute has on the output
                    </div>
                  </app-info-tooltip>
                </div>
                <div class="card-body">
                  <div class="table-responsive myw-scrollbar tbl-maxheight">
                    <ng-container *ngIf='selectedModelFeatureWeight!= null'>
                      <table class="table table-striped table-hover table-vmiddle myw-table">
                        <thead>
                          <tr>
                            <th scope="col">Features</th>
                            <th scope="col">Weight</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let allFeatures of selectedModelFeatureWeight">
                            <td> {{allFeatures[0]}}</td>
                            <td> {{allFeatures[1]}}</td>
                          </tr>
                        </tbody>
                      </table>
                    </ng-container>
                    <ng-container *ngIf='selectedModelFeatureWeight== null'>
                      Feature weights are not available
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="myw-section p-3" *ngIf="isMultiClass">
          <div class="row">
            <div class="col-12 col-lg-8">
              <div class="row h-100">
                <div class="col-md-12 col-lg-5">
                  <div class="card ingrain-card card-hf">
                    <div class="form-row h-100">
                      <div class="col-6 ingrain-card-vr">
                        <div class="card-header">
                          <div class="card-title"><span>Accuracy</span>&nbsp;
                            <app-info-tooltip [className]="'toggleLeft'">
                              <div class="htmlDesignedTooltip">
                                Accuracy is the percentage of correct predictions given by the model. It is given by the
                                number of correct predictions divided by the total number of predictions * 100.
                              </div>
                            </app-info-tooltip>
                            <!-- <a href="javascript:;"><img src="images/info.svg" alt="Info" class="myw-icon myw-12"></a> -->
                          </div>
                        </div>
                        <div class="card-body d-flex flex-column align-items-center justify-content-center h-100">
                          <div class="ingrain-chart" style="margin: -3.5rem 2rem 0rem 0rem;">
                            <app-d3-donut-chart [donutInnerRadius]=55 [selectedModelAccuracy]="selectedAccuracyValue"
                              [defaultModelAccuracyOnLoad]="defaultModelAccuracyOnLoad"
                              [pageInfoForDonutChart]="'Accuracy'">
                            </app-d3-donut-chart>
                          </div>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="card-header">
                          <div class="card-title"><span>Matthews Coefficient </span>
                            <app-info-tooltip [labelTitle]="" [description]="'matthewsCofficient'" [className]="'toggleLeft'"
                              style="font-weight: normal;"> </app-info-tooltip>
                          </div>
                        </div>
                        <div class="card-body d-flex flex-column align-items-center justify-content-center h-100">
                          <div class="ingrain-value fs-20" style="margin-top: -90%;">{{selectedMatthewsCoefficient}}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="card ingrain-card card-hf">
                    <div class="card-header">
                      <div class="card-title">Feature Weights</div>
                      <app-info-tooltip [className]="'toggleLeft'">
                        <div class="htmlDesignedTooltip">
                          Influencing attributes in the trained model arranged in decreasing order of their weights.
                          Weights give a measure of
                          how much influence the particular attribute has on the output
                        </div>
                      </app-info-tooltip>
                    </div>
                    <div class="card-body">
                      <div class="table-responsive  tbl-maxheight">
                        <ng-container *ngIf='selectedModelFeatureWeight!= null'>
                          <div class="myw-scrollbar" style="max-height: 9rem;">
                            <table class="table table-striped table-hover table-vmiddle myw-table">
                              <thead>
                                <tr>
                                  <th scope="col">Features</th>
                                  <th scope="col">Weight</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr *ngFor="let allFeatures of selectedModelFeatureWeight">
                                  <td> {{allFeatures[0]}}</td>
                                  <td>{{allFeatures[1]}}</td>
                                </tr>
                              </tbody>
                            </table>
                          </div>
                        </ng-container>
                        <ng-container *ngIf='selectedModelFeatureWeight== null'>
                          <span>Feature weights are not available</span>
                        </ng-container>
                      </div>
                    </div>

                  </div>
                </div>
                <div class="col-md-12 col-lg-7">
                  <div class="card ingrain-card">
                    <div class="card-header">
                      <div class="card-title"><span>Confusion Matrix </span>
                        <app-info-tooltip>
                          <div class="htmlDesignedTooltip">
                            A confusion matrix is a table that is used to describe the performance of a classification
                            model on a set of test data for which the true values are known.
                            <div>
                              Here,
                              <div style="margin-left: 1.7rem;">
                                <ul>
                                  <li>
                                    <b>True Positives (TP)</b>: These are cases in which we predicted High Priority, and
                                    they do have High Priority.
                                  </li>
                                  <li><b>True Negatives (TN)</b>: We predicted Low Priority, and they do have Low
                                    Priority.
                                  </li>
                                  <li><b>False Positives (FP)</b>: We predicted High Priority, but they are actually Low
                                    Priority. (Also known as a "Type I error.")
                                  </li>
                                  <li><b>False Negatives (FN)</b>: We predicted Low Priority, but they are actually High
                                    Priority. (Also known as a “Type II error.”)
                                  </li>
                                </ul>
                              </div>
                            </div>
                          </div>
                        </app-info-tooltip>
                      </div>
                      <a href="javascript:;" data-toggle="modal" data-target="#confMatrixModal"><img
                          src="assets/images/zoom.svg" alt="Zoom" /></a>
                    </div>
                    <div class="card-body">
                      <div class="">
                        <img style="height: 100%; width: 100%;" [src]="multiClassConfusionMatrix"
                          alt="Confusion Matrix" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-12 col-lg-4" *ngIf="isClusteringFlag">
              <div class="card ingrain-card">
                <div class="card-header">
                  <div class="card-title"> <span>Classification Report </span>&nbsp;
                    <app-info-tooltip [className]="'toggleRight'">
                      <div class="htmlDesignedTooltip">
                        A Classification report is used to measure the quality of predictions from a classification
                        algorithm. How many predictions are True and how many are False.
                        <div style="margin-left: 1.7rem;">
                          <ol style="list-style-type: lower-alpha;">
                            <li>
                              Precision is the ability of a classifier not to label an instance positive that is
                              actually
                              negative. For each class it is defined as the ratio of true positives to the sum of true
                              and
                              false positive</li>
                            <li>Recall is the ability of a classifier to find all positive instances. For each class it
                              is
                              defined as the ratio of true positives to the sum of true positives and false negatives
                            </li>
                            <li>F1- Score is a measure of a Classification model’s accuracy on a dataset and is defined
                              as
                              the harmonic mean of the model’s precision and recall</li>
                            <li>Support is the number of actual occurrences of the class in the dataset</li>
                          </ol>
                        </div>
                      </div>
                    </app-info-tooltip>
                  </div>
                </div>
                <div class="card-body">
                  <div class="table-responsive myw-scrollbar tbl-maxheight">
                    <table class="table table-striped table-hover table-vmiddle myw-table">
                      <thead>
                        <tr>
                          <th scope="col">
                            <div class="d-flex">
                              <span>Target Names</span>
                            </div>
                          </th>
                          <th scope="col" *ngFor="let heading of reportTblHeading">
                            <div class="d-flex">
                              <span>{{heading}}</span>
                            </div>
                          </th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr *ngFor="let colValue of reportColVal">
                          <td *ngFor="let numberOfColumn of reportCollenght; let i = index">
                            <div>{{colValue[i]}}</div>
                          </td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="myw-section p-3" *ngIf="isRegressionR2Val">
          <div class="form-row">
            <div class="col-12 col-lg-4">
              <div class="card ingrain-card">
                <div class="form-row h-100">
                  <div class="col-6 ingrain-card-vr">
                    <div class="card-header">
                      <div class="card-title"><span>R2 Value </span>&nbsp;
                        <app-info-tooltip>
                          <div class="htmlDesignedTooltip">
                            R2 is the measure of accuracy that represents the amount of variation in the target
                            attribute that is accounted for by the input attributes. Usually, the larger the R2, the
                            better the regression model fits the observations.
                            <div>
                              <b> Eg</b>: If R2 is 0.77, 77% of the changes in the target attribute can be explained by
                              the
                              input attributes / It shows that 77% of the variance in the target attribute can be
                              explained by the predictions
                            </div>
                          </div>
                        </app-info-tooltip>
                      </div>
                    </div>
                    <div class="card-body d-flex flex-column align-items-center justify-content-center h-100">
                      <div class="ingrain-chart" style="margin: -4rem 2rem 0rem 0rem;">
                        <app-d3-donut-chart [donutInnerRadius]=55 [selectedModelr2Values]="selectedModelr2Values"
                          [pageInfoForDonutChart]="'RegressionR2Value'"
                          [defaultModelAccuracyOnLoad]="defaultModelAccuracyOnLoad">
                        </app-d3-donut-chart>
                      </div>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="card-header">
                      <div class="card-title"><span>Mse Value </span>
                        <app-info-tooltip style="font-weight: normal;" [labelTitle]="" [description]="'msevalue'">
                        </app-info-tooltip>
                      </div>
                    </div>
                    <div class="card-body d-flex flex-column align-items-center justify-content-center h-100">
                      <div class="ingrain-value fs-20" style="margin-top: -50%;">{{selectedModelmseValues}}</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-12 col-lg-8">
              <div class="card ingrain-card">
                <div class="card-header">
                  <div class="card-title">Feature Weights</div>
                  <app-info-tooltip [className]="'toggleRight'">
                    <div class="htmlDesignedTooltip">
                      Influencing attributes in the trained model arranged in decreasing order of their weights. Weights
                      give a measure of
                      how much influence the particular attribute has on the output
                    </div>
                  </app-info-tooltip>
                </div>
                <div class="card-body">
                  <div class="table-responsive myw-scrollbar tbl-maxheight" style="height: 216px; overflow-x: unset;">
                    <ng-container *ngIf='selectedModelFeatureWeight!= null'>
                      <table class="table table-striped table-hover table-vmiddle myw-table ingrain-table">
                        <thead>
                          <tr>
                            <th scope="col">Features</th>
                            <th scope="col">Weight</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr *ngFor="let allFeatures of selectedModelFeatureWeight">
                            <td> {{allFeatures[0]}}</td>
                            <td> {{allFeatures[1]}}</td>
                          </tr>
                        </tbody>
                      </table>
                    </ng-container>
                    <ng-container *ngIf='selectedModelFeatureWeight == null'>
                      Feature weights are not available
                    </ng-container>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="myw-section p-3" *ngIf="isTimeSeriesVal">
          <div class="form-row">
            <div class="col-6 col-lg-3">
              <div class="card ingrain-card">
                <div class="card-header">
                  <div class="card-title"><span>MAE Value</span></div>
                </div>
                <div class="card-body">
                  <app-half-donut [donutType]="'mae'" [hdwidth]=200 [colors]="['#FFA500','#b8c0ca']" [hdheight]=230
                    [hdvalue]="selectedModelMaeValues">
                  </app-half-donut>
                </div>
              </div>
            </div>
            <div class="col-6 col-lg-3">
              <div class="card ingrain-card">
                <div class="card-header">
                  <div class="card-title"><span>MSE Value</span> </div>
                </div>
                <div class="card-body">
                  <app-half-donut [donutType]="'mse'" [hdwidth]=200 [colors]="['#6db473','#b8c0ca']" [hdheight]=230
                    [hdvalue]="selectedModelmseValues">
                  </app-half-donut>
                </div>
              </div>
            </div>
            <div class="col-12 col-lg-6">
              <div class="card ingrain-card">
                <div class="card-header">
                  <div class="card-title">Test Data - Actual vs Forecast</div>
                  <div>
                    <span class="spandot" style="background-color: #10ADD3; margin-top: 5px;"></span>
                    <span style="vertical-align: sub;word-break: break-all;">
                      Actual
                    </span>
                    <span class="spandot" style="background-color: #6DB473; margin-top: 5px;"></span>
                    <span style="vertical-align: sub;word-break: break-all;">
                      Forecast
                    </span>
                  </div>
                </div>
                <div class="card-body myw-scrollbar" style="max-height: 250px;">
                  <app-line-chart [lineChartData]="selectedModelLineChart" [frequencyType]="frequencyType"
                    [lineChartHeight]=300 [lineChartWidth]="screenWidth">
                  </app-line-chart>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row mt-3" *ngIf="showTextPreProcessDiv">
          <ng-container *ngIf="!isTextPreProcessing">
            <div class="col-sm-12 col-md-12 col-lg-12">
              <div class="ingrAI-box-container">
                <div class="row" style="padding-bottom: 50px;">
                  <div class="col-md-3 col-lg-4">
                    <div class="ingrAI-heading txtCenter" style="padding-right: 162px;">Accuracy
                      <app-info-tooltip>
                        <div class="htmlDesignedTooltip">
                          Accuracy is the percentage of correct predictions given by the model. It is given by the
                          number of correct predictions divided by the total number of predictions * 100.
                        </div>
                      </app-info-tooltip>
                    </div>
                    <div class="ingrAI-chart dvcharts-topmargin" style="height: 200px;">
                      <app-d3-donut-chart [donutInnerRadius]=70 [selectedModelAccuracy]="selectedAccuracyValue"
                        [defaultModelAccuracyOnLoad]="defaultModelAccuracyOnLoad" [pageInfoForDonutChart]="'Accuracy'">
                      </app-d3-donut-chart>
                    </div>
                    <div class="ingrAI-heading txtCenter" style="padding-right: 190px;">F1 Score</div>
                    <div class="ingrAI-chart" style="margin-top: 16px;">
                      <label class="txtCenter"
                        style="padding-left: 80px; font-weight: bold;">{{selectedModelF1Score}}</label>
                    </div>
                  </div>
                  <div class="col-md-6 col-lg-4" style="padding-left: 0px;">
                    <div class="ingrAI-heading txtCenter" style="padding-left: 0px;
                  padding-right: 35px;">Confusion Matrix</div>
                    <div class="ingrAI-chart dvcharts-topmargin">
                      <table class="tblConfusionMatrix" style="margin-top: -12px;">
                        <tbody>
                          <tr>
                            <td class="actual-td">
                              <div style="margin: 0px -256px 0px 0px;">Predicted</div>
                            </td>
                          </tr>
                          <tr>
                            <td class="totaltd" style="padding-left: 20px;" colspan="2">
                              Total n {{sumofTrueFalseValues}}
                            </td>
                            <td class="positive-color" style="border-right: 2px solid white;">
                              Yes
                            </td>
                            <td class="positive-color">
                              No
                            </td>
                            <td class="totalrow-right">Rows Sum</td>
                          </tr>
                          <tr>
                            <td class="predicted-td" rowspan="2">
                              <div style="transform: rotate(270deg);">Actual</div>
                            </td>
                            <td class="positive-color" style="border-bottom: 2px solid white;">Yes</td>
                            <td>
                              <span class="">TP </span><span class="numbers-weight">
                                {{selectedModelTruePositive}}
                              </span>
                            </td>
                            <td>

                              <span class=""> FN </span><span class="numbers-weight">
                                {{selectedModelFalseNegative}}
                              </span>
                            </td>
                            <td class="totalrow-right">
                              {{selectedModelTruePositive + selectedModelFalseNegative}}
                            </td>
                          </tr>
                          <tr>
                            <td class="positive-color">No</td>
                            <td>
                              <span class="">FP </span> <span class="numbers-weight">
                                {{selectedModelFalsePositive}}
                              </span>
                            </td>
                            <td>
                              <span class="">TN </span><span class="numbers-weight">
                                {{selectedModelTrueNegative}}
                              </span>
                            </td>
                            <td class="totalrow-right">
                              {{selectedModelFalsePositive + selectedModelTrueNegative}}
                            </td>
                          </tr>
                          <tr>
                            <td colspan="2" class="blank-bottmtd column-sum">Column Sum</td>
                            <td class="blank-bottmtd bottom-totaltd">
                              <span> {{selectedModelTruePositive + selectedModelFalsePositive}}</span>
                            </td>
                            <td class="blank-bottmtd bottom-totaltd">
                              {{selectedModelFalseNegative + selectedModelTrueNegative}}
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                  <div class="col-md-6 col-lg-4">
                    <div class="ingrAI-heading txtCenter" style="padding-right: 30px;">Roc/Auc Curves</div>
                    <div class="ingrAI-chart">
                      <img style="height: 315px; width: 345px"
                        [src]="domSanitizer.bypassSecurityTrustUrl(selectedFineTuneImg_64)" alt="Select Image" />
                    </div>
                  </div>
                  <!-- <div class="col-md-3 col-lg-4">
            </div> -->
                </div>
              </div>
            </div>
          </ng-container>
          <ng-container *ngIf="isTextPreProcessing">
            <div class="col-sm-12 col-md-12 col-lg-12">
              <div class="ingrAI-box-container">
                <div class="row flex-wrap">
                  <div class="col-xl-2">
                    <div class="ingrAI-heading text-center" style="padding-bottom: 8px; padding-left: 37px;">
                      Accuracy
                    </div>
                    <div class="ingrAI-chart" style="height: 202px;">
                      <app-d3-donut-chart [donutInnerRadius]=70 [selectedModelAccuracy]="selectedAccuracyValue"
                        [defaultModelAccuracyOnLoad]="defaultModelAccuracyOnLoad" [pageInfoForDonutChart]="'Accuracy'">
                      </app-d3-donut-chart>
                    </div>
                  </div>
                  <div class="col-xl-3">
                  </div>
                  <div class="col-xl-4" style="height:547px;">
                    <div class="ingrAI-heading txtCenter" style="padding-right: 155px;font-weight: normal;">Matthews
                      Coefficient</div>
                    <div class="ingrAI-chart" style="margin-top: 16px;">
                      <label class="txtCenter"
                        style="padding-left: 80px; font-weight: bold;">{{selectedMatthewsCoefficient}}</label>
                    </div>
                  </div>
                  <div class="col-xl-3">
                  </div>
                </div>
              </div>
            </div>
          </ng-container>
        </div>
      </ng-template>
    </div>
  </fieldset>
</div>
<!--  -->

<ng-template #confirmRetrainModels>
  <div class="deploymodle-confirmpopup">
    <div class="modal-header" style="border-bottom: none;">
      <h5 class="modal-title" id="saveViewModalTitle">&nbsp;</h5>
      <button type="button" class="close pull-right" style="cursor: pointer;" aria-label="Close"
        (click)="modalRef.hide()">
        <svg class="ingrAI-icon-svg ingrAI-icon-svg-md">
          <use xlink:href="#ingrAI-icon-close"></use>
        </svg>
      </button>
    </div>
    <div class="modal-body">
      {{retrainModelMsg}}
      <div class="modal-footer" style="border-top: none;">
        <button type="button" class="btn btn-secondary" style=" font-size: 1rem;" (click)="decline()">No</button>
        <button type="button" class="btn btn-primary" style=" font-size: 1rem;" (click)="confirm()">Yes</button>
      </div>
    </div>
  </div>
</ng-template>


<!-- Confusion Matrix Modal -->
<div class="modal" id="confMatrixModal" data-backdrop="static" data-keyboard="false" tabindex="-1"
  aria-labelledby="confMatrixModalTitle" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="confMatrixModalTitle">Confusion Matrix</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&nbsp;</span>
        </button>
      </div>
      <div class="modal-body myw-scrollbar">
        <div class="my-2" style="text-align: center;">
          <img [src]="multiClassConfusionMatrix" alt="Confusion Matrix" />
        </div>
      </div>
    </div>
  </div>
</div>
<!-- /Confusion Matrix Modal -->